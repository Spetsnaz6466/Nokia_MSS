function main()
 string line,DEV[],IP[],USER,PASSWORD,PERIOD[];
 integer x,y,z;
 
 z=1; y=59;
 USER="NKFjjj"; PASSWORD="jjkjk*";
 
  for(x=z;x<=y;x++)
   DEV[x]=DEVICES(x); DEV[x]=strreplace(DEV[x],"_"," "); 
   strscan(DEV[x],"%s %s",DEV[x],IP[x]); //DEV="MSSING02_2"; IP="10.68.46.129";
   print("*%d/%d %s %s\n",x,y,DEV[x],IP[x]);
   oMSS_Crear_Devices( DEV[x],IP[x],USER,PASSWORD);
     if(sniff())   
       tx("ZIAI:USERID=%s;",USER);
         if(getline(line,"'PASSWORD VALIDITY TIME LEFT:  '")) 
           PERIOD[x]= PHRASE(line,"PASSWORD VALIDITY TIME LEFT:  ");
         endif
     else 
       print("Sin acceso a %s\n",DEV[x]);
       PERIOD[x]="NO-ACCESS";
     endif
     deviceclose(DEV[x]);
  endfor
  for(x=z;x<=y;x++)
    print("*%d/%d %s %s %s\n",x,y,DEV[x],IP[x],PERIOD[x]);
  endfor
endfunction

void function oMSS_Crear_Devices(string DEV, string IP,string USER,string PASSWORD)
 USER="NKFNAB"; PASSWORD="NKFNAB.2021*";
 if(devicecreate(1,DEV, IP+":22", 1, 1, 2,2))
  //TCPIP=1, NAME, IP/PORT, NO_DX=0, PERMANENT=1, SSH=2, SSH_VER=2
   setloginq(DEV, "ENTER USERNAME <", "ENTER PASSWORD <", 1);
   setlogin(DEV,USER,PASSWORD, 1);
   settransmitdelay(1,500,550);
   print("device create ... OK\n");
   device(DEV); dxprompts(ST_PROMPTS,ON);promptcheck(2);
 else
   abort("device create FAILED\n");
 endif
endfunction

string function DEVICES(integer x)
  string DEV[],DEV_IP[];
DEV[1]="MSS01ALK-D"; DEV_IP[1]="192.168.131.33";
DEV[2]="MSS01BAR-D"; DEV_IP[2]="192.168.32.65";
DEV[3]="MSS01BUC-D"; DEV_IP[3]="192.168.32.134";
DEV[4]="MSS01CAL-D"; DEV_IP[4]="192.168.32.208";
DEV[5]="MSS01ING-D"; DEV_IP[5]="192.168.91.20";
DEV[6]="MSS01PAS-D"; DEV_IP[6]="192.168.140.11";
DEV[7]="MSS01PER-D"; DEV_IP[7]="192.168.50.65";
DEV[8]="MSS01SAI-D"; DEV_IP[8]="192.168.237.134";
DEV[9]="MSS01SIN-D"; DEV_IP[9]="192.168.141.6";
DEV[10]="MSS01TOB-D"; DEV_IP[10]="192.168.66.1";
DEV[11]="MSS01VEN-D"; DEV_IP[11]="192.168.133.6";
DEV[12]="MSS02ALK-D"; DEV_IP[12]="192.168.131.64";
DEV[13]="MSS02ARA-D"; DEV_IP[13]="192.168.25.140";
DEV[14]="MSS02BUC-D"; DEV_IP[14]="192.168.32.154";
DEV[15]="MSS02CAL-D"; DEV_IP[15]="192.168.32.1";
DEV[16]="MSS02FON-D"; DEV_IP[16]="192.168.63.6";
DEV[17]="MSS02MED-D"; DEV_IP[17]="192.168.33.1";
DEV[18]="MSS02PER-D"; DEV_IP[18]="192.168.50.95";
DEV[19]="MSS02SIN-D"; DEV_IP[19]="192.168.141.38";
DEV[20]="MSS02TOB-D"; DEV_IP[20]="192.168.66.22";
DEV[21]="MSS02VEN-D"; DEV_IP[21]="192.168.133.56";
DEV[22]="MSS03ARA-D"; DEV_IP[22]="192.168.25.148";
DEV[23]="MSS03BAR-D"; DEV_IP[23]="192.168.32.83";
DEV[24]="MSS03BUC-D"; DEV_IP[24]="192.168.34.49";
DEV[25]="MSS03CAL-D"; DEV_IP[25]="192.168.32.33";
DEV[26]="MSS03MED-D"; DEV_IP[26]="192.168.33.28";
DEV[27]="MSS03PER-D"; DEV_IP[27]="192.168.223.1";
DEV[28]="MSS03PRA-D"; DEV_IP[28]="192.168.33.163";
DEV[29]="MSS03VEN-D"; DEV_IP[29]="192.168.133.117";
DEV[30]="MSS04ARA-D"; DEV_IP[30]="192.168.49.29";
DEV[31]="MSS04BAR-D"; DEV_IP[31]="192.168.93.6";
DEV[32]="MSS04CAL-D"; DEV_IP[32]="192.168.32.49";
DEV[33]="MSS04MED-D"; DEV_IP[33]="192.168.59.31";
DEV[34]="MSS04VEN-D"; DEV_IP[34]="192.168.133.146";
DEV[35]="MSS05ARA-D"; DEV_IP[35]="192.168.49.113";
DEV[36]="MSS05MED-D"; DEV_IP[36]="192.168.59.121";
DEV[37]="MSS05VEN-D"; DEV_IP[37]="192.168.236.75";
DEV[38]="MSS06ARA-D"; DEV_IP[38]="192.168.55.1";
DEV[39]="MSS06MED-D"; DEV_IP[39]="192.168.59.165";
DEV[40]="MSS06VEN-D"; DEV_IP[40]="10.58.0.1";
DEV[41]="MSS07ARA-D"; DEV_IP[41]="192.168.55.55";
DEV[42]="MSS07VEN-D"; DEV_IP[42]="10.58.0.17";
DEV[43]="MSSALK01-D"; DEV_IP[43]="10.58.40.33";
DEV[44]="MSSALK02-D"; DEV_IP[44]="10.70.12.193";
DEV[45]="MSSARA01-D"; DEV_IP[45]="10.58.12.1";
DEV[46]="MSSBUC01-D"; DEV_IP[46]="10.58.48.66";
DEV[47]="MSSING01-D"; DEV_IP[47]="10.58.44.82";
DEV[48]="MSSMAR01-D"; DEV_IP[48]="10.58.96.1";
DEV[49]="MSSMGA01-D"; DEV_IP[49]="10.58.92.33";
DEV[50]="MSSPER01-D"; DEV_IP[50]="10.58.60.49";
DEV[51]="MSSTRI01-D"; DEV_IP[51]="10.58.89.49";
DEV[52]="MSSTRI02-D"; DEV_IP[52]="10.67.65.193";
DEV[53]="MSSTRI03-D"; DEV_IP[53]="10.67.145.1";
DEV[54]="MSSVEN01-D"; DEV_IP[54]="10.58.0.113";
DEV[55]="MSSMGA02-D"; DEV_IP[55]="10.58.92.194";
DEV[56]="MSS01CAR-D"; DEV_IP[56]="192.168.32.208";
DEV[57]="MSSARA02-D"; DEV_IP[57]="10.66.67.193";
DEV[58]="MSSVEN02-D"; DEV_IP[58]="10.66.27.65";
DEV[59]="MSSING02-D"; DEV_IP[59]="10.68.46.129";
return DEV[x]+"_"+DEV_IP[x];
endfunction

string function PHRASE(string line,string FRASE)
  FRASE=strreplace(line,FRASE,""); strscan(FRASE,"%s",FRASE);  
  return FRASE;
endfunction